<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



    <!-- TAILWIND CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FONT AWESOME CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- CSS -->
    <link rel="stylesheet" href="./style/style.css">

    <title>Boolzapp</title>
</head>
<body>
    
    <div id="app">
        <div class="bg-container relative h-dvh">
            <!-- BACKGROUND -->
            <div class="background-small h-48 bg-background-green"></div>
            <div class="background-big h-[calc(100vh-192px)] bg-background-gray"></div>

            <!-- BOOLZAPP -->
            <div id="boolzapp" class="flex absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[80%] h-[700px] z-10 ">
                
                <!--? CONTACTS SECTION -->
                <section class="contacts h-full w-1/3">

                    <!-- PANNELLO UTENTE -->
                    <div class="user-navbar-container flex justify-between items-center h-[60px] bg-[#ebebeb]">

                            <!-- IMMAGINE PROFILO E NOME UTENTE -->
                        <div class="user-navbar-left h-full flex items-center ml-3">
                            <img src="./img/avatar_io.jpg" alt="A user profile/'s picture" class="w-[50px] h-[50px] rounded-full ">
                            <span>Federico</span>
                        </div>

                        <div class="user-navbar-right">
                            <div class="icons-container text-slate-400 text-2xl me-5 flex">
                                <i class="fa-solid fa-circle-notch me-5"></i>
                                <i class="fa-solid fa-message me-5"></i>
                                <i class="fa-solid fa-ellipsis-vertical"></i>
                            </div>
                        </div>

                    </div>

                    <!-- BARRA NOTIFICHE -->
                    <div class="notifications-container flex items-center h-[80px] bg-[#8dd9fc]">
                        <div class="icon-container ml-4">
                            <i class="fa-solid fa-bell-slash text-[#8dd9fc] bg-white rounded-full text-2xl p-2.5"></i>
                        </div>
                        <div class="text-container ml-3">
                            <p class="text-sm font-medium">Ricevi notifiche di nuovi messaggi</p>
                            <p class="text-xs underline">Attiva notifiche desktop</p>
                        </div>
                    </div>

                    <!-- BARRA DI RICERCA -->
                    <!-- !inserire funzione di filtro -->
                    <div class="search-container h-[40px] bg-[#fafafa] flex items-center gap-2">
                        <i class="fa-solid fa-magnifying-glass px-6 py-1 bg-white rounded-md"></i>
                        <input type="text" placeholder="Cerca o inizia una nuova chat" class="w-2/3 text-sm rounded-md px-3 py-1" v-model="userFilter" @keyup="filterContact(this.userFilter, this.contacts)">
                    </div>

                    <!-- LISTA DEI CONTATTI -->
                    <div class="contact-list-container h-[calc(100%-180px)] bg-white flex flex-col gap-4">
                        <article v-for="(contact, contactIndex) in contacts" :key="contact.name" class="flex items-center hover:bg-slate-300 relative" @click="focusContact(contactIndex)" :class="{'hidden': contact.visible===false}">

                            <div class="image-container">
                                <img :src="`${contact.avatar}.jpg`" :alt="`${contact.name} profile pic`" class="size-[50px] rounded-full">
                            </div> 

                            <div class="contact-info-container ml-4">
                                <span>{{contact.name}}</span>
                                <p class="text-slate-400 text-xs">Ultimo messaggio inviato</p>
                            </div>

                            <span class="absolute top-2 right-2 text-slate-400 text-xs">12:00</span>
                            
                        </article>
                    </div>
                </section>

                <!--? CHAT SECTION -->
                <section class="chat h-full w-2/3">

                        <!-- DESTINATARIO CHAT -->
                    <div class="user-navbar-container flex justify-between items-center h-[60px] bg-[#ebebeb]">

                        <div class="user-navbar-left h-full flex items-center ml-3">
                            <img :src="`${this.contacts[this.activeContact].avatar}.jpg`" alt="A user profile/'s picture" class="w-[50px] h-[50px] rounded-full ">
                            <div class="info-container">
                                <span class="font-medium">{{this.contacts[this.activeContact].name}}</span>
                                <!-- !perchÃ¨ non riesco a selezionare l'ultimo elemento dell'array messages?                                   xxxx -->
                                <p class="text-xs text-slate-700">Ultimo accesso oggi alle <span>{{this.contacts[this.activeContact].messages[1].date.split(" ")[1].slice(0,5)}}</span></p>
                            </div>
                        </div>

                        <div class="icons-container text-slate-400 text-2xl me-6 flex gap-6">
                                <i class="fa-solid fa-magnifying-glass"></i>
                                <i class="fa-solid fa-paperclip"></i>
                                <i class="fa-solid fa-ellipsis-vertical"></i>
                        </div>

                    </div>

                        <!-- BOX MESSAGGI -->
                    <div class="chat-container overflow-auto flex flex-col gap-4 h-[calc(100%-120px)] bg-[url('./img/mine.jpg')] p-16">

                        <!-- MESSAGGIO -->
                        <article  :class="(message.status==='sent') ? 'msg-sent' : 'msg-received'" class="w-fit overflow-x-auto text-justify max-w-[40%] py-3 px-3 rounded-lg mb-2.5 text-sm flex flex-col" v-for="(message, index) in contacts[this.activeContact].messages" :key="index">
                            <h1 class="mb-1">{{message.message}}</h1>
                            <span class="text-[.7em] text-slate-500">{{message.date.split(" ")[1].slice(0,5)}}</span>
                        </article>

                    </div>

                        <!-- INPUT FIELD -->
                    <div class="user-chat-input flex justify-between items-center h-[60px] bg-[#ebebeb] p-6">
                        <i class="fa-regular fa-face-smile text-2xl text-slate-500"></i>
                        <input type="text" v-model="userMessage" placeholder="Scrivi un messaggio" class="w-5/6 py-2 px-3 text-sm rounded-md" @keyup.enter="sendNewMessage">
                        <i class="fa-solid fa-microphone text-2xl text-slate-500"></i>
                    </div>
                </section>

            </div>
        </div>
    </div>

    <!-- LUXON JS -->
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>    
    <!-- VUE 3 -->
    <script src='https://unpkg.com/vue@3/dist/vue.global.js'></script>
    <!-- JS -->
    <script src="./script/script.js"></script>
</body>
</html>


<!-- ! sistemare la grandezza dei messaggi per adattarli al contenuto
    !funzione cancella messaggio -->